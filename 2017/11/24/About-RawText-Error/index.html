<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="/style/style.css">
<script>
    var NlviConfig = {
        title: "Personal Blog",
        author: "Shangwei Yin",
        theme: "banderole",
        lightbox: true,
        animate: true,
        baseUrl: "/",
        search: false
    }
</script>



    <link rel="stylesheet" href="/script/lib/lightbox/css/lightbox.min.css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css">




    <link rel="icon" href="img/favicon.png">







<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Personal Blog">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name= "format-detection" content="telephone=no" />
<meta name="keywords" content="nlvi, Nlvi" />

  <link rel="apple-touch-icon"  sizes="72x72"  href="img/favicon.png">
  <link rel="apple-touch-icon-precomposed"  sizes="72x72"  href="img/favicon.png">


  <meta name="subtitle" content="以梦为马，负了昭华">


  <meta name="description" content="个人博客">


  <meta name="keywords" content="前端,js,jquery,javascript,html5,开发者,程序猿,程序媛,极客,编程,代码,开源,IT网站,Developer,Programmer,Coder,Geek,html,css,css3,用户体验,ShadowSocks,ReactNative" />


  <meta name="keywords" content="react native, Nlvi" />

  <title> 关于React Native中【根据变量的值是否为空来控制组件的显示与否】的问题小结 · Personal Blog </title>
</head>
<body>
  <div class="progress">
  <div class="progress-inner"></div>
</div>
  
  
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
  <div class="tagcloud-inner">
    <a href="/tags/ShadowSocks/" style="font-size: 14px;">ShadowSocks</a> <a href="/tags/markdown/" style="font-size: 14px;">markdown</a> <a href="/tags/node/" style="font-size: 14px;">node</a> <a href="/tags/nvm/" style="font-size: 14px;">nvm</a> <a href="/tags/react-native/" style="font-size: 14px;">react native</a>
  </div>
</div>  
  

  <div class="container">

    <header class="header" id="header">
  <div class="header-wrapper">
    <div class="logo">
  <div class="logo-inner syuanpi tvIn">
    <span><a href="/">Personal Blog</a></span>
    
      <span id="subtitle">以梦为马，负了昭华</span>
    
  </div>
</div>
    <nav class="main-nav">
        
  <ul class="main-nav-list syuanpi tvIn">
  
  
    
      
    
    <li class="menu-item">
      <a href="/" id="article">
        <span class="base-name">Article</span>
        
      </a>
    </li>  
  
    
      
    
    <li class="menu-item">
      <a href="/archives" id="archives">
        <span class="base-name">Archives</span>
        
      </a>
    </li>  
  
    
      
    
    <li class="menu-item">
      <a href="javascript:;" id="tags">
        <span class="base-name">Tags</span>
        
      </a>
    </li>  
  
    
      
    
    <li class="menu-item">
      <a href="/about" id="about">
        <span class="base-name">About Me</span>
        
      </a>
    </li>  
  
  </ul>
  
</nav>
    
    
  </div>
</header>
<div class="mobile-header">
  <div class="mobile-header-body">
    <div class="mobile-header-list">
      
        
            <div class="mobile-nav-item">
                <a href="/">
                    <span>Article</span>
                    
                    
                </a>
            </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/archives">
                    <span>Archives</span>
                    
                    
                </a>
            </div>
        
      
        
          <div class="mobile-nav-item inner-cloud">
            <div class="mobile-nav-tag">
              <a href="javascript:;" id="mobile-tags">
                <span>Tags</span>
                
                
              </a>
            </div>
            <div class="mobile-nav-tagcloud">
              <div class="mobile-tagcloud-inner">
                <a href="/tags/ShadowSocks/" style="font-size: 14px;">ShadowSocks</a> <a href="/tags/markdown/" style="font-size: 14px;">markdown</a> <a href="/tags/node/" style="font-size: 14px;">node</a> <a href="/tags/nvm/" style="font-size: 14px;">nvm</a> <a href="/tags/react-native/" style="font-size: 14px;">react native</a>
              </div>
            </div>
          </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/about">
                    <span>About Me</span>
                    
                    
                </a>
            </div>
        
      
    </div>
  </div>
  <div class="mobile-header-nav">
    <div class="mobile-header-item" id="mobile-left">
      <div class="header-menu-item">
        <span class="header-menu-line"></span>
      </div>
    </div>
    <h1 class="mobile-header-title">
      <a href="/">Personal Blog</a>
    </h1>
    <div class="mobile-header-item"></div>
  </div>
</div>
    <div class="container-inner">
      <main class="main" id="main">
        <div class="main-wrapper">
          
    
  <article class="
  post
   is_post 
  ">
    <header class="post-header">
      <div class="post-time syuanpi riseIn-light back-1">
        <div class="post-time-wrapper">
          <span>2017-11-24</span>
          
            
              <span class="post-category"><a href="/categories/Technology/">Technology</a></span>
            
          
          
            
              <aside class="post-tags syuanpi riseIn-light back-3">
              
                <a href="/tags/react-native/">react native</a>
              
              </aside>
            
          
        </div>
      </div>
      <h1 class="post-title syuanpi riseIn-light back-2">
        
          关于React Native中【根据变量的值是否为空来控制组件的显示与否】的问题小结
        
      </h1>
    </header>
    <div class="post-content syuanpi riseIn-light back-3">
      
        <p><img src="/img/2017-11-24-img.jpeg" alt="image">  </p>
<h2 id="问题说明"><a href="#问题说明" class="headerlink" title="问题说明"></a>问题说明</h2><p>在开发React Native过程中，我们常常会根据一个变量的值是否为空来控制组件的显示与否。<br>一个简单的做法是<code>{ someVariable &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code>  </p>
<p>今天就因为写了这样的代码踩到了一个坑，导致App Crash了。<br>Error内容：<font color="red">RawText “” must be wrapped in an explicit <text> component.</text></font></p>
<p>分析了一波，发现是数据问题导致的。当下面的代码中someVariable的值为空字符串<code>&#39;&#39;</code>的时候，就会出现这种Error。<br><code>{ someVariable &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code></p>
<a id="more"></a>
<h2 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h2><p>为了分析这个问题，针对someVariable为空的情况做了一些测试，结果如下：<br><strong>case 1.</strong> <code>{ &#39;&#39; &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <strong>有Error，App会Crash</strong><br><strong>case 2.</strong> <code>{ 0 &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <strong>有Error，App会Crash</strong><br><strong>case 3.</strong> <code>{ null &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; 没有Error, <code>&lt;Text&gt;</code>组件不会显示<br><strong>case 4.</strong> <code>{ undefined &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; 没有Error, <code>&lt;Text&gt;</code>组件不会显示<br><strong>case 5.</strong> <code>{ NaN &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <strong>有Error，App会Crash</strong><br><strong>case 6.</strong> <code>{ [] &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; 没有Error, <code>&lt;Text&gt;</code>组件会显示<br><strong>case 7.</strong> <code>{ {} &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; 没有Error, <code>&lt;Text&gt;</code>组件会显示  </p>
<h2 id="原因分析"><a href="#原因分析" class="headerlink" title="原因分析"></a>原因分析</h2><p>为什么会出现以上结果呢？<br>为了分析这个问题首先需要明白<code>expr1 &amp;&amp; expr2</code>的含义。<br>这个表达式是说当<code>expr1</code>为false的时候，会返回<code>expr1</code>，否则会返回<code>expr2</code>。<br>那么<code>&#39;&#39;</code>|<code>0</code>|<code>null</code>|<code>undefined</code>|<code>NaN</code>|<code>[]</code>|<code>{}</code>这些值到底是true还是false呢，我们可以在Chrome Console上面通过两个非操作<code>!!</code>来测试一下。</p>
<p><img src="/img/2017-11-24-chrome-console.png" width="500"></p>
<p>从上面结果可以看到，<code>&#39;&#39;</code>|<code>0</code>|<code>null</code>|<code>undefined</code>|<code>NaN</code>的值是false，<code>[]</code>|<code>{}</code>的值为true。<br>好了，通过以上分析我们可以得到case 1 ~ case 6的结果如下：<br><strong>case 1.</strong> <code>{ &#39;&#39; &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <code>{ &#39;&#39; }</code><br><strong>case 2.</strong> <code>{ 0 &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <code>{ 0 }</code><br><strong>case 3.</strong> <code>{ null &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <code>{ null }</code><br><strong>case 4.</strong> <code>{ undefined &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <code>{ undefined }</code><br><strong>case 5.</strong> <code>{ NaN &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <code>{ NaN }</code><br><strong>case 6.</strong> <code>{ [] &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <code>{ &lt;Text&gt;some text&lt;/Text&gt; }</code><br><strong>case 7.</strong> <code>{ {} &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code> =&gt; <code>{ &lt;Text&gt;some text&lt;/Text&gt; }</code>  </p>
<p>在React Native中<code>{ &#39;&#39; }</code>|<code>{ 0 }</code> |<code>{ NaN }</code>会被当做文本字符串，必须要包含在<code>&lt;Text&gt;</code>组件中，所以<strong>case 1</strong>、<strong>case 2</strong>、<strong>case 5</strong>会导致App Crash；<strong>case 3</strong>、<strong>case 4</strong>不会报错，也不会在页面上显示任何东西；<strong>case 5</strong>、<strong>case 6</strong>会在页面上显示<code>some text</code>文本。</p>
<h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2><p>为了规避App Crash的风险，有两个简单的方案来实现【根据变量的值是否为空来控制组件的显示与否】：<br>1.当变量类型为Object或Array时，可以使用lodash的isEmpty方法<br><code>{ !_.isEmpty(someVariable) &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code><br>2.当变量为其他类型时，使用两个非操作<br><code>{ !!someVariable &amp;&amp; &lt;Text&gt;some text&lt;/Text&gt; }</code>  </p>

      
    
    </div>
    
      
      
    
  </article>
  
    
  <nav class="article-page">
    
      <a href="/2017/11/30/install-node-in-mac/" id="art-left" class="art-left">
        <span class="next-title">
          <i class="iconfont icon-left"></i>如何正确的安装nvm、node(mac)
        </span>
      </a>
    
    
      <a href="/2017/11/16/markdown-syntax/" id="art-right" class="art-right">
        <span class="prev-title"> 
          Markdown常用语法<i class="iconfont icon-right"></i>  
        </span>
      </a>
    
  </nav>

    

  
   
    
  
  <aside class="post-toc">
    <span class="title" id="toc-switch"><span>Index</span></span>
    <div class="toc-inner syuanpi back-1 fallIn-light">
      <li class="title-link"><a href="javascript:;" class="toTop">关于React Native中【根据变量的值是否为空来控制组件的显示与否】的问题小结</a></li>
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#问题说明"><span class="toc-text">问题说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#测试结果"><span class="toc-text">测试结果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原因分析"><span class="toc-text">原因分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解决方案"><span class="toc-text">解决方案</span></a></li></ol>
    </div>
  </aside>


  


        </div>
      </main>

      <footer class="footer syuanpi fadeIn" id="footer">
  <hr>
  <div class="footer-wrapper">
    <div class="left">
      <div class="contact-icon">
    
    
    
    
    
    
    
    
        
            <a href="https://github.com/yinshangwei" class="iconfont icon-github" title="github"></a>
        
        
        
        
        
        
        
    
        
        
            <a href="https://weibo.com/yinshangwei" class="iconfont icon-weibo" title="weibo"></a>
        
        
        
        
        
        
    
        
        
        
        
        
            <a href="https://www.facebook.com/yinshangwei" class="iconfont icon-facebook" title="facebook"></a>
        
        
        
    
</div>
    </div>
    <div class="right">
      <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>2017 ~ 2018</span>
        <span>❤</span>
        <span>Shangwei Yin</span>
    </div>
    <!--
    <div class="theme">
        <span>
            Powered by
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            Theme
            <a href="https://github.com/ColMugX/hexo-theme-Nlvi"> Nlvi </a>
        </span>
    </div>
    -->
    
</div>
    </div>
  </div>
</footer>
    </div>
  </div>
  <script src="/script/lib/jquery/jquery-3.2.1.min.js"></script>


    <script src="/script/lib/lightbox/js/lightbox.min.js"></script>






<script src="/script/src/nlvi.js"></script>
<script src="/script/src/utils.js"></script>
<script src="/script/scheme/balance.js"></script>
<script src="/script/src/plugins.js"></script>
<script src="/script/bootstarp.js"></script>


<div class="backtop syuanpi dead toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>


</body>
</html>
